<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Hive中Reduce个数是如何计算的"><meta name="keywords" content="Hive"><meta name="author" content="Tunan"><meta name="copyright" content="Tunan"><title>Hive中Reduce个数是如何计算的 | TUNANのBlog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#hive-exec-reducers-bytes-per-reducer"><span class="toc-number">1.</span> <span class="toc-text">hive.exec.reducers.bytes.per.reducer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hive-exec-reducers-max"><span class="toc-number">2.</span> <span class="toc-text">hive.exec.reducers.max</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapred-reduce-tasks-mapreduce-job-reduces"><span class="toc-number">3.</span> <span class="toc-text">mapred.reduce.tasks/mapreduce.job.reduces</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#源码分析"><span class="toc-number">4.</span> <span class="toc-text">源码分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/xiaoqi.jpg"></div><div class="author-info__name text-center">Tunan</div><div class="author-info__description text-center">BigData Developer</div><div class="follow-button"><a href="#">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">215</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">38</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">34</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="https://hadoop.apache.org/docs/r2.10.0/hadoop-project-dist/hadoop-common/SingleCluster.html" target="_blank" rel="noopener">HADOOP</a><a class="author-info-links__name text-center" href="https://cwiki.apache.org/confluence/display/Hive/" target="_blank" rel="noopener">HIVE</a><a class="author-info-links__name text-center" href="http://archive.cloudera.com/cdh5/cdh/5/" target="_blank" rel="noopener">CDH</a><a class="author-info-links__name text-center" href="http://flume.apache.org/" target="_blank" rel="noopener">FLUME</a><a class="author-info-links__name text-center" href="https://azkaban.github.io/" target="_blank" rel="noopener">AZKABAN</a><a class="author-info-links__name text-center" href="https://www.maxinhong.com/" target="_blank" rel="noopener">叶梨子</a><a class="author-info-links__name text-center" href="https://www.cnblogs.com/qingyunzong" target="_blank" rel="noopener">老铁</a><a class="author-info-links__name text-center" href="https://blog.csdn.net/jim8973/" target="_blank" rel="noopener">飞哥</a><a class="author-info-links__name text-center" href="https://vinxikk.github.io/" target="_blank" rel="noopener">vinx</a><a class="author-info-links__name text-center" href="http://dongxicheng.org/" target="_blank" rel="noopener">懂西成(Hadoop技术内幕作者)</a><a class="author-info-links__name text-center" href="https://www.cnblogs.com/xing901022/" target="_blank" rel="noopener">xingoo</a><a class="author-info-links__name text-center" href="https://www.cnblogs.com/itboys/tag/" target="_blank" rel="noopener">大葱拌豆腐</a><a class="author-info-links__name text-center" href="https://www.cnblogs.com/shishanyuan" target="_blank" rel="noopener">郭景瞻(图解Spark作者)</a><a class="author-info-links__name text-center" href="https://segmentfault.com/u/wishdaren_5c243b920a3eb" target="_blank" rel="noopener">Wish大人</a><a class="author-info-links__name text-center" href="https://www.cnblogs.com/huxi2b/" target="_blank" rel="noopener">huxi_2b(kafka)</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/soroush-golpoor-1497416-unsplash.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">TUNANのBlog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">Hive中Reduce个数是如何计算的</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-23</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Hive/">Hive</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">1.6k</span><span class="post-meta__separator">|</span><span>Reading time: 7 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>我们在使用<a href="https://www.iteblog.com/archives/tag/hive/" target="_blank" rel="noopener">Hive</a>查询数据的时候经常会看到如下的输出：</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="type">Query</span> <span class="type">ID</span> = iteblog_20160704104520_988f81d4<span class="number">-0</span>b82<span class="number">-4778</span>-af98<span class="number">-43</span>cc1950d357</span><br><span class="line"><span class="type">Total</span> jobs = <span class="number">1</span></span><br><span class="line"><span class="type">Launching</span> <span class="type">Job</span> <span class="number">1</span> out of <span class="number">1</span></span><br><span class="line"><span class="type">Number</span> of reduce tasks determined at compile time: <span class="number">1</span></span><br><span class="line"><span class="type">In</span> order to change the average load <span class="keyword">for</span> a reducer (in bytes):</span><br><span class="line">  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;</span><br><span class="line"><span class="type">In</span> order to limit the maximum number of reducers:</span><br><span class="line">  set hive.exec.reducers.max=&lt;number&gt;</span><br><span class="line"><span class="type">In</span> order to set a constant number of reducers:</span><br><span class="line">  set mapreduce.job.reduces=&lt;number&gt;</span><br></pre></td></tr></table></figure>

<p>很明显，上面的输出信息展示了<a href="https://www.iteblog.com/archives/tag/hive/" target="_blank" rel="noopener">Hive</a>同设置Reduce的三种方法，本文将在源码的角度解释这三个参数的作用。在进入代码介绍之前让我们先来看看这三个参数的含义。</p>
<h2 id="hive-exec-reducers-bytes-per-reducer"><a href="#hive-exec-reducers-bytes-per-reducer" class="headerlink" title="hive.exec.reducers.bytes.per.reducer"></a>hive.exec.reducers.bytes.per.reducer</h2><p>此参数从<a href="https://www.iteblog.com/archives/tag/hive/" target="_blank" rel="noopener">Hive</a> 0.2.0开始引入。在Hive 0.14.0版本之前默认值是1G(1,000,000,000)；而从Hive 0.14.0开始，默认值变成了256M(256,000,000)，可以参见HIVE-7158和HIVE-7917。这个参数的含义是每个Reduce处理的字节数。比如输入文件的大小是1GB，那么会启动4个Reduce来处理数据。</p>
<h2 id="hive-exec-reducers-max"><a href="#hive-exec-reducers-max" class="headerlink" title="hive.exec.reducers.max"></a>hive.exec.reducers.max</h2><p>此参数从Hive 0.2.0开始引入。在Hive 0.14.0版本之前默认值是999；而从Hive 0.14.0开始，默认值变成了1009；可以参见HIVE-7158和HIVE-7917。这个参数的含义是最多启动的Reduce个数。比如<code>input size/hive.exec.reducers.bytes.per.reducer&gt;hive.exec.reducers.max</code>，那么Hive启动的Reduce个数为<code>hive.exec.reducers.max</code>；反之为<code>input size/hive.exec.reducers.bytes.per.reducer</code>。这个参数只有在<code>mapred.reduce.tasks/mapreduce.job.reduces</code>设置为负数的时候才有效。</p>
<h2 id="mapred-reduce-tasks-mapreduce-job-reduces"><a href="#mapred-reduce-tasks-mapreduce-job-reduces" class="headerlink" title="mapred.reduce.tasks/mapreduce.job.reduces"></a>mapred.reduce.tasks/mapreduce.job.reduces</h2><p>此参数从Hive 0.1.0开始引入。默认值是-1。此参数的含义是Reduce的个数，典型的情况是设置成接近可用节点的质数。如果<code>mapred.job.tracker</code>的值是local此参数将会被忽略。在Hadoop中此参数的默认值是1；而在Hive中默认值是-1。通过将此参数设置为-1，Hive将自动计算出应该启动多少个Reduce。</p>
<h2 id="源码分析"><a href="#源码分析" class="headerlink" title="源码分析"></a>源码分析</h2><p>我们已经将三个参数的含义介绍完，现在我们来看看Hive代码中是如何计算Reduce个数的。首先来看看Hive是如何从输入的文件大小计算Reduce个数：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Estimate the number of reducers needed for this job, based on job input,</span></span><br><span class="line"><span class="comment"> * and configuration parameters.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The output of this method should only be used if the output of this</span></span><br><span class="line"><span class="comment"> * MapRedTask is not being used to populate a bucketed table and the user</span></span><br><span class="line"><span class="comment"> * has not specified the number of reducers to use.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the number of reducers.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">estimateNumberOfReducers</span><span class="params">(HiveConf conf, ContentSummary inputSummary,</span></span></span><br><span class="line"><span class="function"><span class="params">                                           MapWork work, <span class="keyword">boolean</span> finalMapRed)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">  <span class="keyword">long</span> bytesPerReducer = conf.getLongVar(HiveConf.ConfVars.BYTESPERREDUCER);</span><br><span class="line">  <span class="keyword">int</span> maxReducers = conf.getIntVar(HiveConf.ConfVars.MAXREDUCERS);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">double</span> samplePercentage = getHighestSamplePercentage(work);</span><br><span class="line">  <span class="keyword">long</span> totalInputFileSize = getTotalInputFileSize(inputSummary, work, samplePercentage);</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// if all inputs are sampled, we should shrink the size of reducers accordingly.</span></span><br><span class="line">  <span class="keyword">if</span> (totalInputFileSize != inputSummary.getLength()) &#123;</span><br><span class="line">    LOG.info(<span class="string">"BytesPerReducer="</span> + bytesPerReducer + <span class="string">" maxReducers="</span></span><br><span class="line">        + maxReducers + <span class="string">" estimated totalInputFileSize="</span> + totalInputFileSize);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    LOG.info(<span class="string">"BytesPerReducer="</span> + bytesPerReducer + <span class="string">" maxReducers="</span></span><br><span class="line">      + maxReducers + <span class="string">" totalInputFileSize="</span> + totalInputFileSize);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// If this map reduce job writes final data to a table and bucketing is being inferred,</span></span><br><span class="line">  <span class="comment">// and the user has configured Hive to do this, make sure the number of reducers is a</span></span><br><span class="line">  <span class="comment">// power of two</span></span><br><span class="line">  <span class="keyword">boolean</span> powersOfTwo = conf.getBoolVar(HiveConf.ConfVars.HIVE_INFER_BUCKET_SORT_NUM_BUCKETS_POWER_TWO) &amp;&amp;</span><br><span class="line">      finalMapRed &amp;&amp; !work.getBucketedColsByDirectory().isEmpty();</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> estimateReducers(totalInputFileSize, bytesPerReducer, maxReducers, powersOfTwo);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">estimateReducers</span><span class="params">(<span class="keyword">long</span> totalInputFileSize, <span class="keyword">long</span> bytesPerReducer,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> maxReducers, <span class="keyword">boolean</span> powersOfTwo)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">double</span> bytes = Math.max(totalInputFileSize, bytesPerReducer);</span><br><span class="line">  <span class="keyword">int</span> reducers = (<span class="keyword">int</span>) Math.ceil(bytes / bytesPerReducer);</span><br><span class="line">  reducers = Math.max(<span class="number">1</span>, reducers);</span><br><span class="line">  reducers = Math.min(maxReducers, reducers);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">int</span> reducersLog = (<span class="keyword">int</span>)(Math.log(reducers) / Math.log(<span class="number">2</span>)) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> reducersPowerTwo = (<span class="keyword">int</span>)Math.pow(<span class="number">2</span>, reducersLog);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (powersOfTwo) &#123;</span><br><span class="line">    <span class="comment">// If the original number of reducers was a power of two, use that</span></span><br><span class="line">    <span class="keyword">if</span> (reducersPowerTwo / <span class="number">2</span> == reducers) &#123;</span><br><span class="line">      <span class="comment">// nothing to do</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (reducersPowerTwo &gt; maxReducers) &#123;</span><br><span class="line">      <span class="comment">// If the next power of two greater than the original number of reducers is greater</span></span><br><span class="line">      <span class="comment">// than the max number of reducers, use the preceding power of two, which is strictly</span></span><br><span class="line">      <span class="comment">// less than the original number of reducers and hence the max</span></span><br><span class="line">      reducers = reducersPowerTwo / <span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// Otherwise use the smallest power of two greater than the original number of reducers</span></span><br><span class="line">      reducers = reducersPowerTwo;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> reducers;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>totalInputFileSize</code>的值就是输入文件的总大小，然后通过<code>estimateReducers</code>函数估算Reduce个数；其中<code>bytesPerReducer</code>和<code>maxReducers</code>分别是<code>hive.exec.reducers.bytes.per.reducer</code>和<code>hive.exec.reducers.max</code>的值，powersOfTwo参数如果在使用bucket并且<code>hive.exec.infer.bucket.sort.num.buckets.power.two</code>设置成true才会起作用，此参数默认值为false。所以Reduce的计算公式主要就是下面四行代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">double</span> bytes = Math.max(totalInputFileSize, bytesPerReducer);</span><br><span class="line"><span class="keyword">int</span> reducers = (<span class="keyword">int</span>) Math.ceil(bytes / bytesPerReducer);</span><br><span class="line">reducers = Math.max(<span class="number">1</span>, reducers);</span><br><span class="line">reducers = Math.min(maxReducers, reducers);</span><br></pre></td></tr></table></figure>

<p>也就是Reduce最少为1，最大为<code>maxReducers</code>（就是<code>hive.exec.reducers.max</code>的值）。如果<code>powersOfTwo</code>为true，那么Reduce的值将会取小于或大于并且最接近Reduce的值，而且此值是2的指数。</p>
<p>上面代码仅仅是根据输入计算Reduce的个数，最终的设置是通过setNumberOfReducers函数决定的，如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Set the number of reducers for the mapred work.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setNumberOfReducers</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">  ReduceWork rWork = work.getReduceWork();</span><br><span class="line">  <span class="comment">// this is a temporary hack to fix things that are not fixed in the compiler</span></span><br><span class="line">  Integer numReducersFromWork = rWork == <span class="keyword">null</span> ? <span class="number">0</span> : rWork.getNumReduceTasks();</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (rWork == <span class="keyword">null</span>) &#123;</span><br><span class="line">    console</span><br><span class="line">        .printInfo(<span class="string">"Number of reduce tasks is set to 0 since there's no reduce operator"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (numReducersFromWork &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">      console.printInfo(<span class="string">"Number of reduce tasks determined at compile time: "</span></span><br><span class="line">          + rWork.getNumReduceTasks());</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (job.getNumReduceTasks() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">int</span> reducers = job.getNumReduceTasks();</span><br><span class="line">      rWork.setNumReduceTasks(reducers);</span><br><span class="line">      console.printInfo(<span class="string">"Number of reduce tasks not specified. Defaulting to jobconf value of: "</span></span><br><span class="line">          + reducers);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (inputSummary == <span class="keyword">null</span>) &#123;</span><br><span class="line">        inputSummary =  Utilities.getInputSummary(driverContext.getCtx(), work.getMapWork(), <span class="keyword">null</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">int</span> reducers = Utilities.estimateNumberOfReducers(conf, inputSummary, work.getMapWork(),</span><br><span class="line">                                                        work.isFinalMapRed());</span><br><span class="line">      rWork.setNumReduceTasks(reducers);</span><br><span class="line">      console</span><br><span class="line">          .printInfo(<span class="string">"Number of reduce tasks not specified. Estimated from input data size: "</span></span><br><span class="line">          + reducers);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">    console.printInfo(<span class="string">"In order to change the average load for a reducer (in bytes):"</span>);</span><br><span class="line">    console.printInfo(<span class="string">"  set "</span> + HiveConf.ConfVars.BYTESPERREDUCER.varname</span><br><span class="line">        + <span class="string">"=&lt;number&gt;"</span>);</span><br><span class="line">    console.printInfo(<span class="string">"In order to limit the maximum number of reducers:"</span>);</span><br><span class="line">    console.printInfo(<span class="string">"  set "</span> + HiveConf.ConfVars.MAXREDUCERS.varname</span><br><span class="line">        + <span class="string">"=&lt;number&gt;"</span>);</span><br><span class="line">    console.printInfo(<span class="string">"In order to set a constant number of reducers:"</span>);</span><br><span class="line">    console.printInfo(<span class="string">"  set "</span> + HiveConf.ConfVars.HADOOPNUMREDUCERS</span><br><span class="line">        + <span class="string">"=&lt;numbe&gt;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果<code>job.getNumReduceTasks()&gt;0</code>，也就是<code>mapred.reduce.tasks/mapreduce.job.reduces</code>参数的值大于0，此时直接取<code>mapred.reduce.tasks/mapreduce.job.reduces</code>的值作为Reduce的个数；否则将会使用上面<code>estimateNumberOfReducers</code>函数估算Reduce个数，最后都是通过<code>rWork.setNumReduceTasks(reducers)</code>设置Reduce的个数。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol>
<li>Reduce的个数对整个作业的运行性能有很大影响。如果Reduce设置的过大，那么将会产生很多小文件，对NameNode会产生一定的影响，而且整个作业的运行时间未必会减少；如果Reduce设置的过小，那么单个Reduce处理的数据将会加大，很可能会引起OOM异常。</li>
<li>如果设置了<code>mapred.reduce.tasks/mapreduce.job.reduces</code>参数，那么Hive会直接使用它的值作为Reduce的个数；</li>
<li>如果<code>mapred.reduce.tasks/mapreduce.job.reduces</code>的值没有设置（也就是-1），那么Hive会根据输入文件的大小估算出Reduce的个数。根据输入文件估算Reduce的个数可能未必很准确，因为Reduce的输入是Map的输出，而Map的输出可能会比输入要小，所以最准确的数根据Map的输出估算Reduce的个数。</li>
</ol>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined" target="_blank" rel="noopener">Tunan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yerias.github.io/2021/04/23/hive/24/">http://yerias.github.io/2021/04/23/hive/24/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hive/">Hive</a></div><div class="social-share" data-disabled="facebook,twitter,douban,linkedin,diandian"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/04/25/error/11/"><i class="fa fa-chevron-left">  </i><span>Yarn在Shuffle阶段内存不足问题(error in shuffle in fetcher)</span></a></div><div class="next-post pull-right"><a href="/2021/04/23/hive/23/"><span>map和reduce个数的设定</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(/img/soroush-golpoor-1497416-unsplash.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2021 By Tunan</div><div class="framework-info"><span>Driven - </span><a href="#"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="#"><span>Melody</span></a></div><div class="footer_custom_text">大家好，我是图南，很高兴认识你们！</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>